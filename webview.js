'use strict';

module.exports = Franz => {
  const getMessages = function getMessages() {
    let directs = 0;

    if (document.getElementsByClassName('nwa-msg-counter icq-recent_state-read').length > 0) {
      const elements = document.getElementsByClassName('nwa-msg-counter icq-recent_state-read');
      for (let i = 0; i < elements.length; i++) {
        const countLine = parseInt(elements[i].innerText.replace(/[^0-9.]/g, ''), 10);
        if (!isNaN(directs) && countLine > 0) {
          // directs += count_line; // count every message
          directs += 1; // count 1 per channel with messages
        }
      }
    }

    if (isNaN(directs)) {
      directs = 0;
    }

    Franz.setBadge(directs);
  };

  Franz.loop(getMessages);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImljcS93ZWJ2aWV3LmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJGcmFueiIsImdldE1lc3NhZ2VzIiwiZGlyZWN0cyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImxlbmd0aCIsImVsZW1lbnRzIiwiaSIsImNvdW50TGluZSIsInBhcnNlSW50IiwiaW5uZXJUZXh0IiwicmVwbGFjZSIsImlzTmFOIiwic2V0QmFkZ2UiLCJsb29wIl0sIm1hcHBpbmdzIjoiOztBQUFBQSxPQUFPQyxPQUFQLEdBQWtCQyxLQUFELElBQVc7QUFDMUIsUUFBTUMsY0FBYyxTQUFTQSxXQUFULEdBQXVCO0FBQ3pDLFFBQUlDLFVBQVUsQ0FBZDs7QUFFQSxRQUFJQyxTQUFTQyxzQkFBVCxDQUFnQyx1Q0FBaEMsRUFBeUVDLE1BQXpFLEdBQWtGLENBQXRGLEVBQXlGO0FBQ3ZGLFlBQU1DLFdBQVdILFNBQVNDLHNCQUFULENBQWdDLHVDQUFoQyxDQUFqQjtBQUNBLFdBQUssSUFBSUcsSUFBSSxDQUFiLEVBQWdCQSxJQUFJRCxTQUFTRCxNQUE3QixFQUFxQ0UsR0FBckMsRUFBMEM7QUFDeEMsY0FBTUMsWUFBWUMsU0FBU0gsU0FBU0MsQ0FBVCxFQUFZRyxTQUFaLENBQXNCQyxPQUF0QixDQUE4QixVQUE5QixFQUEwQyxFQUExQyxDQUFULEVBQXdELEVBQXhELENBQWxCO0FBQ0EsWUFBSSxDQUFDQyxNQUFNVixPQUFOLENBQUQsSUFBb0JNLFlBQVksQ0FBcEMsRUFBd0M7QUFDdEM7QUFDQU4scUJBQVcsQ0FBWCxDQUZzQyxDQUV4QjtBQUNmO0FBQ0Y7QUFDRjs7QUFFRCxRQUFJVSxNQUFNVixPQUFOLENBQUosRUFBb0I7QUFDbEJBLGdCQUFVLENBQVY7QUFDRDs7QUFFREYsVUFBTWEsUUFBTixDQUFlWCxPQUFmO0FBQ0QsR0FuQkQ7O0FBcUJBRixRQUFNYyxJQUFOLENBQVdiLFdBQVg7QUFDRCxDQXZCRCIsImZpbGUiOiJpY3Evd2Vidmlldy5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gKEZyYW56KSA9PiB7XG4gIGNvbnN0IGdldE1lc3NhZ2VzID0gZnVuY3Rpb24gZ2V0TWVzc2FnZXMoKSB7XG4gICAgbGV0IGRpcmVjdHMgPSAwO1xuXG4gICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ253YS1tc2ctY291bnRlciBpY3EtcmVjZW50X3N0YXRlLXJlYWQnKS5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBlbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ253YS1tc2ctY291bnRlciBpY3EtcmVjZW50X3N0YXRlLXJlYWQnKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY291bnRMaW5lID0gcGFyc2VJbnQoZWxlbWVudHNbaV0uaW5uZXJUZXh0LnJlcGxhY2UoL1teMC05Ll0vZywgJycpLCAxMCk7XG4gICAgICAgIGlmICghaXNOYU4oZGlyZWN0cykgJiYgKGNvdW50TGluZSA+IDApKSB7XG4gICAgICAgICAgLy8gZGlyZWN0cyArPSBjb3VudF9saW5lOyAvLyBjb3VudCBldmVyeSBtZXNzYWdlXG4gICAgICAgICAgZGlyZWN0cyArPSAxOyAvLyBjb3VudCAxIHBlciBjaGFubmVsIHdpdGggbWVzc2FnZXNcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpc05hTihkaXJlY3RzKSkge1xuICAgICAgZGlyZWN0cyA9IDA7XG4gICAgfVxuXG4gICAgRnJhbnouc2V0QmFkZ2UoZGlyZWN0cyk7XG4gIH07XG5cbiAgRnJhbnoubG9vcChnZXRNZXNzYWdlcyk7XG59O1xuIl19